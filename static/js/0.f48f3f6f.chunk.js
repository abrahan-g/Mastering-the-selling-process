(this["webpackJsonpall-in-one"]=this["webpackJsonpall-in-one"]||[]).push([[0],{791:function(e,t){var s=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,r=/^0o[0-7]+$/i,a=/^(?:0|[1-9]\d*)$/,o=parseInt,c=Object.prototype.toString,l=Math.ceil,d=Math.max;function u(e,t,s){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(s=s>i?i:s)<0&&(s+=i),i=t>s?0:s-t>>>0,t>>>=0;for(var r=Array(i);++n<i;)r[n]=e[n+t];return r}function p(e,t,s){if(!h(s))return!1;var n=typeof t;return!!("number"==n?function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=h(e)?c.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(s)&&function(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}(t,s.length):"string"==n&&t in s)&&function(e,t){return e===t||e!==e&&t!==t}(s[t],e)}function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e,t,a){t=(a?p(e,t,a):void 0===t)?1:d(function(e){var t=function(e){if(!e)return 0===e?e:0;if((e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var a=i.test(e);return a||r.test(e)?o(e.slice(2),a?2:8):n.test(e)?NaN:+e}(e))===1/0||e===-1/0){return 17976931348623157e292*(e<0?-1:1)}return e===e?e:0}(e),a=t%1;return t===t?a?t-a:t:0}(t),0);var m=e?e.length:0;if(!m||t<1)return[];for(var b=0,v=0,f=Array(l(m/t));b<m;)f[v++]=u(e,b,b+=t);return f}},855:function(e,t,s){"use strict";s.r(t);var n=s(123),i=s.n(n),r=s(225),a=s(6),o=s(140),c=s(66),l=s.n(c),d=s(34),u=s(130),p=s(321),h=s(38),m=s(13),b=s(81);const v=function(e){let t=e.section,s=e.xapiStatus,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{verb:Object(b.d)(s)?u.i.progressed:u.i.mastered,object:Object(p.c)(t,n),result:Object(p.b)({score:t.score})}};var f=s(4),S=s(92),x=s(167),g=s(61),E=e=>{let t=e.question;const s=t.answers.filter(e=>t.response.indexOf(e.id)>=0).map(e=>e.id).join(u.h.comma),n=t.type===m.j?t.correctAnswerId:t.answers.filter(e=>e.isCorrect).map(e=>e.id).join(u.h.comma),i=e=>t.type===m.j||t.type===m.f?{[Object(g.c)()]:Object(x.g)(e.originalImage)}:Object(g.a)(e.text);return{response:s,correctResponsesPattern:n,interactionType:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:i(e)}))}}},y=s(138);var O=e=>{let t=e.question,s=e.questionContent;const n=t.response,i=t.answerGroups,r=n.data,a=void 0===r?(e=>e.reduce((e,t)=>{let s=t.id;return Object(f.a)({[s]:""},e)},{}))(i):r,o=Object.keys(a).map(e=>"".concat(a[e]).concat(u.h.dot).concat(e)).join(u.h.comma),c=i.map(e=>e.answers.filter(e=>e.isCorrect).map(t=>"".concat(t.text).concat(u.h.dot).concat(e.id)).join(u.h.comma)).join(u.h.comma),l=Object(d.a)(s,1)[0],p=void 0===l?{value:""}:l;return{response:o,correctResponsesPattern:c,interactionType:u.f.fillIn,extensions:{[u.d.content]:Object(y.e)(p.value)}}},j=e=>({response:e.question.response.answeredText,omitScore:!0,interactionType:u.f.other}),L=e=>{let t=e.question;return{response:t.response.map(e=>"".concat(e.id).concat(u.h.dot).concat(e.isCorrect)).join(u.h.comma),correctResponsesPattern:t.answers.map(e=>"".concat(e.id).concat(u.h.dot).concat(e.isCorrect)).join(u.h.comma),interactionType:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:Object(g.a)(e.text)}))}}},w=e=>{let t=e.question,s=e.isXapiPackageMode;return{response:t.response.map(e=>e.id).join(u.h.comma),correctResponsesPattern:t.answers.map(e=>e.id).join(u.h.comma),interactionType:s?u.f.sequencing:u.f.choice,extraActivityDefinition:{choices:t.answers.map(e=>({id:e.id,description:Object(g.a)(e.text)}))}}},P=e=>{let t=e.question;const s=e=>e.map((e,t)=>({id:t.toString(),description:Object(g.a)(e)})),n=t.answers.map(e=>e.key),i=t.answers.map(e=>e.value).filter((e,t,s)=>s.indexOf(e)===t),r=t.answers.map(e=>"".concat(n.indexOf(e.key)).concat(u.h.dot).concat(i.indexOf(e.value))).join(u.h.comma);return{response:n.map((e,s)=>{const n=t.response.find(t=>t.key===e);let r="";return n&&n.shownSelectedValue&&(r=i.indexOf(n.shownSelectedValue)),"".concat(s).concat(u.h.dot).concat(r)}).join(u.h.comma),correctResponsesPattern:r,interactionType:u.f.matching,extraActivityDefinition:{source:s(n),target:s(i)}}};var A=e=>{let t=e.question;const s=t.dropspots.map(e=>e.text).join(u.h.comma),n=t.dropspots.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.comma);return{response:t.dropspots.map(e=>{const s=t.response.find(t=>t.id===e.id);if(!s)return"(-1,-1)";const n=s.items.length&&s.items[0];if(!n)return"(-1,-1)";const i=t.dropspots.find(e=>e.id===n.id);return"(".concat(i.x,",").concat(i.y,")")}).join(u.h.comma),correctResponsesPattern:n,interactionType:u.f.other,extensions:{[u.d.imageUrl]:Object(x.g)(t.originalBackground),[u.d.answerTexts]:s}}},H=e=>{let t=e.question;return{response:t.response.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.comma),correctResponsesPattern:t.spots.map(e=>e.map(e=>"(".concat(e.x,",").concat(e.y,")")).join(u.h.dot)).join(u.h.comma),interactionType:u.f.other,extensions:{[u.d.imageUrl]:Object(x.g)(t.originalBackground)}}};const N=(e,t)=>{let s=Object(d.a)(e,3),n=s[0],i=s[1],r=s[2];return C(n,i,t,function(e){switch(e.type){case m.i:case m.e:case m.j:case m.f:return E;case m.b:return O;case m.g:return j;case m.k:return L;case m.h:return w;case m.l:return P;case m.a:return A;case m.c:return H;default:throw new Error("Question type ".concat(e.type," is not supported"))}}(n)({question:n,questionContent:r,isXapiPackageMode:t}))};function C(e,t,s,n){const i=n.response,a=n.correctResponsesPattern,o=n.interactionType,c=n.extraActivityDefinition,d=n.omitScore,h=n.extensions,m=n.verb,b=function(e,t,s){return r.a.extendContext(new l.a.Context({contextActivities:new l.a.ContextActivities({parent:[Object(p.c)(t,s)]}),extensions:{[u.d.surveyMode]:e.hasOwnProperty("isSurvey")&&e.isSurvey,[u.d.questionType]:e.type}}),s)}(e,t,s);b.extensions=Object.assign(b.extensions,h);let v=Object(f.a)({name:Object(g.a)(e.title),type:u.a.interaction,interactionType:o},a&&{correctResponsesPattern:e.isSurvey?[]:[a]});return v=Object.assign(v,c),{context:b,verb:m||u.i.answered,object:new l.a.Activity({id:Object(S.d)(t.id,e.id,s),definition:new l.a.ActivityDefinition(v)}),result:Object(p.b)({score:e.score,omitScore:d,response:i})}}const R=(e,t)=>{let s=Object(d.a)(e,2);return C(s[0],s[1],t,{interactionType:u.f.other,verb:u.i.experienced})},T={[h.b.PASSED]:u.i.passed,[h.b.FAILED]:u.i.failed,[h.b.IN_PROGRESS]:u.i.progressed},U=(e,t)=>(Object(d.a)(e,1)[0].type===m.d?R:N)(e,t),_=e=>e&&u.i.hasOwnProperty(e)?{verb:u.i[e]}:{verb:u.i.started},I=()=>({verb:u.i.launched}),z=e=>e&&u.i.hasOwnProperty(e)?{verb:u.i[e]}:{verb:u.i.completed},D=e=>{let t=e.course;return{verb:u.i.completed,result:Object(p.b)({score:t.score})}},X=(e,t)=>{let s=e.course,n=e.timeSpent,i=e.xapiStatus;const r={score:s.score,duration:n};return i!==h.b.IN_PROGRESS&&t&&(r.completion=!0,r.success=i===h.b.PASSED),{verb:T[i],result:Object(p.b)(r)}},q=e=>{let t=e.statementsData,s=e.state,n=e.isSubmitOnce,i=void 0!==n&&n,r=e.isXapiPackageMode,a=void 0!==r&&r,o=e.shouldSendCompletedStatement;const c=void 0!==o&&o?[D({course:s.course})]:[];if(!i){return[...t.map(e=>{let t=e.section,s=e.questionData,n=e.course;return[t?v(t,a):[],s?U(s,a):[],X(n,a)]}).flat(2),...c]}const l=Object(d.a)(t,3),u=l[0],p=l[1],h=l[2];return[...u.map(e=>U(e,a)),...p.map(e=>v(e,a)),X(h,a),...c]},k=e=>{let t=e.score,s=e.response;return{verb:u.i.evaluated,result:Object(p.b)({score:t,response:s})}};var M=new class{constructor(){this.courseLaunched=void 0,this.courseStarted=void 0,this.informationContentExperienced=void 0,this.questionAnswered=void 0,this.overallCourseProgressed=void 0,this.courseCompleted=void 0,this.courseEvaluated=void 0,this.listStatement=void 0,this.listStatement=[{name:"courseLaunched",instance:I},{name:"courseStarted",instance:_},{name:"informationContentExperienced",instance:R},{name:"questionAnswered",instance:N},{name:"overallCourseProgressed",instance:q},{name:"courseCompleted",instance:z},{name:"courseEvaluated",instance:k}],this.listStatement.forEach(e=>{this[e.name]=function(){const t=[e.instance(...arguments)].flat();return t.map(e=>new l.a.Statement(e))}})}},V=e=>{console.error("xApi error: [ ".concat($(e)," ]"))};function F(e){console.error("xApi error: [ ".concat($(e)," ]"))}function $(e){return e?e.code&&e.mesg?"code: ".concat(e.code,", message: ").concat(e.mesg):e.toString():"undefined error"}class B extends o.a{constructor(e){let t=e.sendStatement,s=e.shouldHandlerErrors;super(),this.handlers=void 0,this.sendStatement=void 0,this.shouldHandlerErrors=void 0,this.handlers=[],this.sendStatement=t,this.shouldHandlerErrors=s}createHandler(e){return async t=>{await this.handle(e,t)}}async handle(e,t){try{const s=M[e](t);await this.sendStatement(s)}catch(s){if(!this.shouldHandlerErrors)throw s;V(s)}}}var G=s(52),Q=s(791),J=s.n(Q);var W=class{constructor(){this.statements=void 0,this.statements=[]}push(e){this.statements.push(...[e].flat())}shift(){const e=this.statements;return this.statements=[],e}};let K=!0;var Y=new class{constructor(){this.settings=void 0,this.promises=void 0,this.xapiLmsPromises=void 0,this.lrsStatementStorage=void 0,this.xapiLmsStatementsStorage=void 0}initialize(e){this.settings=e,this.promises=[],this.lrsStatementStorage=new W}initializeXapiLms(e){this.settings=e,this.xapiLmsPromises=[],this.xapiLmsStatementsStorage=new W}sendLrsStatements(e){let t=e;return r.a.isDefaultLrs(this.settings.xApi)||(t=this.getAllowedStatements(e,this.settings.xApi.allowedVerbs),t.length)?(this.lrsStatementStorage.push(t),this.sendStorageStatements(this.lrsStatementStorage,this.promises,r.a.lrs),Promise.all(this.promises)):null}sendNpsStatement(e){this.doSend(r.a.nps.sendStatements.bind(r.a.nps),e)}sendLxpStatement(e){this.doSend(r.a.lxp.sendStatements.bind(r.a.lxp),e)}sendXapiLmsStatements(e){const t=this.getAllowedStatements(e,this.settings.xApi.lmsAllowedVerbs);return t.length?(this.xapiLmsStatementsStorage.push(t),this.sendStorageStatements(this.xapiLmsStatementsStorage,this.xapiLmsPromises,r.a.xapiLms),Promise.all(this.xapiLmsPromises)):null}getAllowedStatements(e,t){return e.filter(e=>t.includes(e.verb.display["en-US"]))}sendStorageStatements(e,t,s){const n=e.shift();if(0!==n.length){const e=J()(n,10).map(e=>this.doSend(s.sendStatements.bind(s),e));t.push(e)}}doSend(e,t){return new Promise((s,n)=>{e(t,e=>{if(e){const t=e.find(e=>null!==e.err);t?n(t.err):(!K&&a.a.emit(a.b.APP_ONLINE),K=!0,s())}})}).catch(()=>{setTimeout(()=>{K&&a.a.emit(a.b.APP_OFFLINE_OR_SERVER_ERROR),K=!1,this.doSend(e,t)},G.a)})}};class Z extends B{constructor(){super({sendStatement:Y.sendLrsStatements.bind(Y),shouldHandlerErrors:!0})}initialize(e){let t=e.isScoringOfContentPagesAllowed;this.handlers=[{event:a.b.COURSE_SUBMIT,instance:this.createHandler("overallCourseProgressed")},{event:a.b.COURSE_STARTED,instance:this.createHandler("courseLaunched")},{event:a.b.QUESTION_ANSWERED,instance:this.createHandler("overallCourseProgressed")}],t&&this.handlers.push({event:a.b.INFORMATION_CONTENT_EXPERIENCED,instance:this.createHandler("overallCourseProgressed")})}}class ee extends B{constructor(){super({sendStatement:Y.sendNpsStatement.bind(Y)})}initialize(){this.handlers=[{event:a.b.COURSE_EVALUATED,instance:this.createHandler("courseEvaluated")}]}}class te extends B{constructor(){super({sendStatement:Y.sendLxpStatement.bind(Y)})}initialize(e){this.handlers=Object.keys(e).map(e=>{if(u.c.hasOwnProperty(e)){const t=u.c[e],s=u.e[t];return{event:t,instance:this.createHandler(s)}}return null})}}class se extends B{constructor(){super({sendStatement:Y.sendXapiLmsStatements.bind(Y),shouldHandlerErrors:!0})}initialize(e){let t=e.isScoringOfContentPagesAllowed;this.handlers=[{event:a.b.COURSE_SUBMIT_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")},{event:a.b.COURSE_STARTED,instance:this.createHandler("courseLaunched")},{event:a.b.QUESTION_ANSWERED_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")}],t&&this.handlers.push({event:a.b.INFORMATION_CONTENT_EXPERIENCED_XAPI_LMS,instance:this.createHandler("overallCourseProgressed")})}}t.default=new class{constructor(){this.lrsEventHandler=void 0,this.npsEventHandler=void 0,this.lxpEventHandler=void 0,this.xapiLmsEventHandler=void 0,this.settings=void 0,this.defaultLrsUrl=void 0,this.defaultNpsUrl=void 0,this.defaultLxpUrl=void 0,this.lrsEventHandler=new Z,this.npsEventHandler=new ee,this.lxpEventHandler=new te,this.xapiLmsEventHandler=new se}subscribeLrs(){try{r.a.initializeLrs(this.settings.xApi,this.defaultLrsUrl)}catch(e){this.unsubscribeLrs(),V(e)}this.lrsEventHandler.on()}subscribeNps(){try{r.a.initializeNps(this.defaultNpsUrl)}catch(e){this.unsubscribeNps(),F(e)}this.npsEventHandler.on()}subscribeLxp(e){try{r.a.initializeLxp(this.defaultLxpUrl,e)}catch(t){this.unsubscribeLxp(),F(t)}this.lxpEventHandler.on()}subscribeXapiLms(){try{r.a.initializeXapiLms()}catch(e){this.unsubscribeXapiLms(),V(e)}this.xapiLmsEventHandler.on()}unsubscribeLrs(){this.lrsEventHandler.off()}unsubscribeNps(){this.npsEventHandler.off()}unsubscribeLxp(){this.lxpEventHandler.off()}unsubscribeXapiLms(){this.xapiLmsEventHandler.off()}unsubscribeAll(){this.unsubscribeLrs(),this.unsubscribeNps(),this.unsubscribeLxp(),this.unsubscribeXapiLms()}initializeXapiLms(e){let t=e.settings;this.xapiLmsEventHandler.initialize(t),Y.initializeXapiLms(t)}initialize(e){var t;let s=e.settings,n=e.defaultLrsUrl,a=e.defaultNpsUrl,o=e.defaultLxpUrl,c=e.course,l=e.actor;this.settings=s,this.defaultLrsUrl=n,this.defaultNpsUrl=a,this.defaultLxpUrl=o,this.lrsEventHandler.initialize(s),this.npsEventHandler.initialize(),i()(null===(t=s.lxp)||void 0===t?void 0:t.xApiVerbs)||this.lxpEventHandler.initialize(s.lxp.xApiVerbs),r.a.initialize({course:c,actor:l}),Y.initialize(s)}}}}]);